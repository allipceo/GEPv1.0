# G038 진위형 문제 관리 시스템 개발 절차서 v1.0

## 📋 프로젝트 개요

### 프로젝트명
**진위형 문제 관리 시스템 (QManager) - 기출문제 기반 파생문제 통합 관리**

### 개발 목적
기존 QGENERATOR로 생성된 진위형 문제들을 기출문제별로 검토, 수정, 삭제, 추가할 수 있는 통합 관리 시스템 개발

### 개발 기간
**2025년 8월 27일 ~ 8월 29일 (3일)**

### 개발자
**서대리**

### 검토자
**조대표**

---

## 🎯 시스템 요구사항

### 1. 핵심 기능
- **기출문제별 파생문제 검토**: 좌측에서 기출문제 선택 시 우측에 해당 파생문제들 표시
- **파생문제 관리**: 생성, 수정, 삭제, 추가 기능
- **실시간 통계**: 기출문제 수 + 파생문제 수 동시 표시
- **안전한 데이터 관리**: 백업 및 롤백 기능

### 2. 사용자 시나리오
1. 좌측 기출문제 스크롤에서 특정 문제 클릭
2. 우측에 해당 기출문제의 파생 진위형 문제들 표시
3. 빈칸에 새로운 문제 생성 또는 기존 문제 수정
4. 불필요한 문제는 체크박스 해제로 삭제
5. 모든 변경사항 저장 및 업로드

### 3. 기술 요구사항
- **프론트엔드**: HTML5, CSS3, Vanilla JavaScript, Tailwind CSS
- **백엔드**: Flask (기존 GEP 서버 활용)
- **데이터베이스**: JSON 파일 기반
- **아키텍처**: 모듈화된 독립 시스템

---

## 🏗️ 시스템 아키텍처

### 1. 전체 구조
```
GEP 메인 서버 (app.py)
├── 기존 GEP 기능들 (학습, 통계)
├── QGENERATOR (/qgenerator) - 기존
└── QMANAGER (/admin/qmanager) - 신규 개발
```

### 2. 데이터 구조
```json
{
  "metadata": {
    "version": "QManager V1.0",
    "total_original_questions": 1440,
    "total_derived_questions": 22,
    "last_update": "2025-08-27T..."
  },
  "question_mappings": {
    "ABAA-241": {
      "original": { /* 기출문제 정보 */ },
      "derived": [
        {
          "QCODE": "ABAA-241-B1",
          "QUESTION": "파생 문제 1",
          "ANSWER": "O",
          "STATUS": "ACTIVE"
        }
      ]
    }
  }
}
```

### 3. 파일 구조
```
qmanager/
├── index.html              # 메인 HTML
├── styles.css              # CSS 스타일
├── js/
│   ├── qmanager.js         # 핵심 로직
│   ├── data-handler.js     # 데이터 처리
│   └── ui-controller.js    # UI 제어
└── README.md               # 문서
```

---

## 📅 개발 일정

### Phase 1: 기본 구조 및 UI (1일)
**목표**: 기본 UI 및 데이터 로딩 기능 구현

#### 1.1 프로젝트 구조 생성
- [ ] `qmanager/` 디렉토리 생성
- [ ] 기본 HTML 파일 작성
- [ ] CSS 스타일 파일 작성
- [ ] JavaScript 파일 구조 생성

#### 1.2 기본 UI 구현
- [ ] 좌측 패널: 기출문제 스크롤 (기존 QGENERATOR 활용)
- [ ] 우측 패널: 파생문제 관리 인터페이스
- [ ] 반응형 레이아웃 구현
- [ ] 기본 스타일링 적용

#### 1.3 데이터 로딩 기능
- [ ] 기출문제 데이터 로딩 (`gep_master_v1.0.json`)
- [ ] 파생문제 데이터 로딩 (`gep_generated_questions.json`)
- [ ] 데이터 매핑 로직 구현
- [ ] 기본 검증 기능

### Phase 2: 핵심 기능 구현 (1일)
**목표**: 파생문제 관리 기능 완성

#### 2.1 파생문제 표시 기능
- [ ] 기출문제 클릭 시 해당 파생문제들 로드
- [ ] 파생문제 목록 표시
- [ ] 문제별 상태 표시 (ACTIVE/INACTIVE)
- [ ] 실시간 통계 업데이트

#### 2.2 파생문제 관리 기능
- [ ] 새로운 파생문제 추가 기능
- [ ] 기존 파생문제 수정 기능
- [ ] 파생문제 삭제 기능 (체크박스)
- [ ] 일괄 처리 기능

#### 2.3 데이터 저장 기능
- [ ] 변경사항 임시 저장
- [ ] 최종 저장 및 업로드
- [ ] 백업 및 롤백 기능
- [ ] 에러 처리 및 복구

### Phase 3: 통합 및 최적화 (1일)
**목표**: GEP 대문 통합 및 성능 최적화

#### 3.1 GEP 대문 통합
- [ ] Flask 라우팅 추가 (`/admin/qmanager`)
- [ ] 정적 파일 서빙 설정
- [ ] API 엔드포인트 구현
- [ ] 메인 페이지 링크 추가

#### 3.2 성능 최적화
- [ ] 데이터 로딩 최적화
- [ ] UI 반응성 개선
- [ ] 메모리 사용량 최적화
- [ ] 에러 처리 강화

#### 3.3 테스트 및 검증
- [ ] 단위 테스트 실행
- [ ] 통합 테스트 실행
- [ ] 사용자 시나리오 테스트
- [ ] 성능 테스트

---

## 🛠️ 개발 세부 절차

### 1단계: 프로젝트 구조 생성

#### 1.1 디렉토리 생성
```bash
mkdir qmanager
mkdir qmanager/js
```

#### 1.2 기본 파일 생성
- `qmanager/index.html`: 메인 HTML 파일
- `qmanager/styles.css`: CSS 스타일 파일
- `qmanager/js/qmanager.js`: 핵심 JavaScript 로직
- `qmanager/js/data-handler.js`: 데이터 처리 모듈
- `qmanager/js/ui-controller.js`: UI 제어 모듈

#### 1.3 Flask 라우팅 추가
`app.py`에 다음 라우팅 추가:
```python
@app.route('/admin/qmanager')
def qmanager():
    return send_from_directory('qmanager', 'index.html')

@app.route('/admin/qmanager/<path:filename>')
def qmanager_static(filename):
    return send_from_directory('qmanager', filename)
```

### 2단계: 기본 UI 구현

#### 2.1 HTML 구조 작성
```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QManager - 진위형 문제 관리 시스템</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/admin/qmanager/styles.css">
</head>
<body>
    <!-- 좌측: 기출문제 스크롤 -->
    <!-- 우측: 파생문제 관리 -->
</body>
</html>
```

#### 2.2 CSS 스타일링
- Tailwind CSS 활용
- 반응형 디자인 적용
- 기존 QGENERATOR와 일관된 스타일

#### 2.3 JavaScript 기본 구조
```javascript
class QManager {
    constructor() {
        this.originalQuestions = [];
        this.derivedQuestions = [];
        this.selectedOriginal = null;
        this.init();
    }
    
    async init() {
        await this.loadData();
        this.setupEventListeners();
        this.renderUI();
    }
}
```

### 3단계: 데이터 처리 로직

#### 3.1 데이터 로딩
```javascript
async loadData() {
    // 기출문제 로딩
    const originalResponse = await fetch('/static/data/gep_master_v1.0.json');
    this.originalQuestions = await originalResponse.json();
    
    // 파생문제 로딩
    const derivedResponse = await fetch('/static/data/gep_generated_questions.json');
    this.derivedQuestions = await derivedResponse.json();
    
    // 데이터 매핑
    this.createQuestionMappings();
}
```

#### 3.2 데이터 매핑
```javascript
createQuestionMappings() {
    this.questionMappings = {};
    
    // 기출문제별로 파생문제 그룹화
    this.derivedQuestions.questions.forEach(derived => {
        const sourceQCODE = derived.SOURCE_QCODE;
        if (!this.questionMappings[sourceQCODE]) {
            this.questionMappings[sourceQCODE] = {
                original: this.findOriginalQuestion(sourceQCODE),
                derived: []
            };
        }
        this.questionMappings[sourceQCODE].derived.push(derived);
    });
}
```

### 4단계: UI 제어 로직

#### 4.1 기출문제 선택 처리
```javascript
selectOriginalQuestion(qcode) {
    this.selectedOriginal = this.questionMappings[qcode];
    this.renderDerivedQuestions();
    this.updateStatistics();
}
```

#### 4.2 파생문제 렌더링
```javascript
renderDerivedQuestions() {
    const container = document.getElementById('derivedQuestionsContainer');
    const derived = this.selectedOriginal.derived;
    
    container.innerHTML = derived.map((question, index) => `
        <div class="derived-question-item">
            <input type="checkbox" class="question-checkbox" data-qcode="${question.QCODE}">
            <textarea class="question-input" data-qcode="${question.QCODE}">${question.QUESTION}</textarea>
            <div class="answer-options">
                <label><input type="radio" name="answer-${index}" value="O" ${question.ANSWER === 'O' ? 'checked' : ''}> O</label>
                <label><input type="radio" name="answer-${index}" value="X" ${question.ANSWER === 'X' ? 'checked' : ''}> X</label>
            </div>
        </div>
    `).join('');
}
```

### 5단계: 데이터 저장 로직

#### 5.1 변경사항 수집
```javascript
collectChanges() {
    const changes = {
        added: [],
        modified: [],
        deleted: []
    };
    
    // 체크박스 해제된 문제들 (삭제 대상)
    document.querySelectorAll('.question-checkbox:not(:checked)').forEach(checkbox => {
        changes.deleted.push(checkbox.dataset.qcode);
    });
    
    // 수정된 문제들
    document.querySelectorAll('.question-input').forEach(input => {
        const qcode = input.dataset.qcode;
        const originalQuestion = this.findDerivedQuestion(qcode);
        if (originalQuestion.QUESTION !== input.value) {
            changes.modified.push({
                qcode: qcode,
                question: input.value,
                answer: this.getSelectedAnswer(qcode)
            });
        }
    });
    
    return changes;
}
```

#### 5.2 데이터 저장
```javascript
async saveChanges(changes) {
    try {
        // 백업 생성
        await this.createBackup();
        
        // 변경사항 적용
        await this.applyChanges(changes);
        
        // 파일 저장
        await this.saveToFile();
        
        this.showNotification('변경사항이 성공적으로 저장되었습니다.', 'success');
    } catch (error) {
        console.error('저장 실패:', error);
        this.showNotification('저장 중 오류가 발생했습니다.', 'error');
    }
}
```

### 6단계: GEP 대문 통합

#### 6.1 Flask 라우팅 추가
`app.py`에 다음 코드 추가:
```python
# QManager 라우팅
@app.route('/admin/qmanager')
def qmanager():
    return send_from_directory('qmanager', 'index.html')

@app.route('/admin/qmanager/<path:filename>')
def qmanager_static(filename):
    return send_from_directory('qmanager', filename)

@app.route('/admin/qmanager/js/<path:filename>')
def qmanager_js(filename):
    return send_from_directory('qmanager/js', filename)

# QManager API 엔드포인트
@app.route('/admin/api/qmanager/save', methods=['POST'])
def qmanager_save():
    try:
        data = request.json
        # 데이터 저장 로직
        return jsonify({'success': True, 'message': '저장 완료'})
    except Exception as e:
        return jsonify({'success': False, 'error': str(e)}), 500
```

#### 6.2 메인 페이지 링크 추가
`templates/pages/index.html`에 QManager 링크 추가:
```html
<div class="admin-tools">
    <a href="/qgenerator" class="btn btn-primary">QGENERATOR</a>
    <a href="/admin/qmanager" class="btn btn-secondary">QMANAGER</a>
</div>
```

---

## 🧪 테스트 및 검증 절차

### 1. 단위 테스트
- [ ] 데이터 로딩 테스트
- [ ] 데이터 매핑 테스트
- [ ] UI 렌더링 테스트
- [ ] 데이터 저장 테스트

### 2. 통합 테스트
- [ ] 기출문제 선택 → 파생문제 표시 테스트
- [ ] 파생문제 수정 → 저장 테스트
- [ ] 파생문제 삭제 → 저장 테스트
- [ ] 새로운 파생문제 추가 → 저장 테스트

### 3. 사용자 시나리오 테스트
- [ ] 시나리오 1: 기존 파생문제 검토 및 수정
- [ ] 시나리오 2: 불필요한 파생문제 삭제
- [ ] 시나리오 3: 새로운 파생문제 추가
- [ ] 시나리오 4: 일괄 처리 기능 테스트

### 4. 성능 테스트
- [ ] 데이터 로딩 성능 (목표: < 2초)
- [ ] UI 반응성 (목표: < 100ms)
- [ ] 메모리 사용량 (목표: < 50MB)
- [ ] 동시 사용자 처리 (목표: 10명)

---

## 🔧 디버깅 및 문제 해결

### 1. 일반적인 문제들
- **데이터 로딩 실패**: 파일 경로 확인, JSON 형식 검증
- **UI 렌더링 오류**: DOM 요소 존재 확인, 이벤트 리스너 검증
- **데이터 저장 실패**: 권한 확인, 디스크 공간 확인
- **성능 저하**: 데이터 캐싱, 불필요한 DOM 조작 최소화

### 2. 디버깅 도구
- **브라우저 개발자 도구**: 콘솔 로그, 네트워크 탭
- **Flask 디버그 모드**: 상세한 에러 메시지
- **데이터 검증**: JSON 스키마 검증
- **성능 모니터링**: 메모리 사용량, 응답 시간 측정

### 3. 롤백 절차
```bash
# 문제 발생 시 롤백
git log --oneline  # 커밋 히스토리 확인
git reset --hard bc35e06  # 안전 지점으로 롤백
```

---

## 📊 성공 지표

### 1. 기능 완성도
- [ ] 기출문제별 파생문제 검토: 100%
- [ ] 파생문제 관리 기능: 100%
- [ ] 데이터 저장 및 백업: 100%
- [ ] GEP 대문 통합: 100%

### 2. 성능 지표
- [ ] 데이터 로딩 시간: < 2초
- [ ] UI 반응성: < 100ms
- [ ] 메모리 사용량: < 50MB
- [ ] 에러 발생률: < 1%

### 3. 사용자 만족도
- [ ] 직관적인 인터페이스: 90% 이상
- [ ] 기능 완성도: 95% 이상
- [ ] 안정성: 99% 이상

---

## 📝 문서화

### 1. 개발 문서
- [ ] API 문서 작성
- [ ] 사용자 매뉴얼 작성
- [ ] 개발자 가이드 작성
- [ ] 배포 가이드 작성

### 2. 코드 문서화
- [ ] 함수별 주석 작성
- [ ] 클래스별 문서화
- [ ] API 엔드포인트 문서화
- [ ] 설정 파일 문서화

---

## 🚀 배포 및 운영

### 1. 배포 준비
- [ ] 코드 리뷰 완료
- [ ] 테스트 완료
- [ ] 문서화 완료
- [ ] 백업 생성

### 2. 배포 절차
- [ ] 서버 중지
- [ ] 코드 업데이트
- [ ] 데이터베이스 마이그레이션
- [ ] 서버 재시작
- [ ] 기능 검증

### 3. 모니터링
- [ ] 성능 모니터링
- [ ] 에러 로그 모니터링
- [ ] 사용자 피드백 수집
- [ ] 정기 점검

---

## 📞 연락처 및 지원

### 개발팀
- **개발자**: 서대리
- **검토자**: 조대표
- **지원**: 기술 지원 및 유지보수

### 문서 정보
- **문서 버전**: v1.0
- **작성일**: 2025-08-27
- **최종 업데이트**: 2025-08-27

---

**🎯 이 절차서에 따라 체계적으로 개발을 진행하겠습니다!**
