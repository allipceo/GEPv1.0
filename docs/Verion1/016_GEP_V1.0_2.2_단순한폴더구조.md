# GEP V1.0 - 2.2 단순한 폴더 구조

## 📋 개요
**General Exam Platform (GEP) V1.0**의 단순하고 확장 가능한 폴더 구조 설계

### 🎯 설계 원칙
- **ACIU S4 검증된 아키텍처 기반**: 성공한 구조 재활용
- **레고블록 방법론**: 작은 모듈의 재활용 극대화
- **단순성**: 복잡한 구조보다 실용적 해결책
- **확장성**: 미래 기능 추가 시 구조 변경 최소화

---

## 🏗️ 폴더 구조 설계

### **1. 루트 디렉토리 구조**

```
GEP_V1.0/
├── 📱 app.py                    # 메인 Flask 애플리케이션 (200줄 이하)
├── 📊 database/                 # 데이터베이스 관련
│   ├── __init__.py
│   ├── models.py               # 데이터 모델 (150줄 이하)
│   ├── migrations.py           # 데이터 마이그레이션 (100줄 이하)
│   └── gep_master.db           # SQLite 데이터베이스
├── 🔧 services/                 # 비즈니스 로직 서비스
│   ├── __init__.py
│   ├── question_service.py     # 문제 관리 서비스 (200줄 이하)
│   ├── user_service.py         # 사용자 관리 서비스 (200줄 이하)
│   ├── stats_service.py        # 통계 관리 서비스 (200줄 이하)
│   └── payment_service.py      # 결제 관리 서비스 (150줄 이하)
├── 🌐 routes/                   # API 라우트
│   ├── __init__.py
│   ├── question_routes.py      # 문제 관련 API (150줄 이하)
│   ├── user_routes.py          # 사용자 관련 API (150줄 이하)
│   ├── stats_routes.py         # 통계 관련 API (150줄 이하)
│   └── payment_routes.py       # 결제 관련 API (100줄 이하)
├── 🎨 templates/                # HTML 템플릿
│   ├── base.html               # 기본 템플릿 (100줄 이하)
│   ├── home.html               # 메인 페이지 (150줄 이하)
│   ├── question.html           # 문제 풀이 페이지 (200줄 이하)
│   ├── statistics.html         # 통계 페이지 (200줄 이하)
│   └── settings.html           # 설정 페이지 (150줄 이하)
├── 🎯 static/                   # 정적 파일
│   ├── css/
│   │   ├── main.css            # 메인 스타일 (200줄 이하)
│   │   ├── mobile.css          # 모바일 스타일 (150줄 이하)
│   │   └── components.css      # 컴포넌트 스타일 (100줄 이하)
│   ├── js/
│   │   ├── app.js              # 메인 JavaScript (200줄 이하)
│   │   ├── question.js         # 문제 풀이 로직 (200줄 이하)
│   │   ├── stats.js            # 통계 로직 (150줄 이하)
│   │   └── utils.js            # 유틸리티 함수 (100줄 이하)
│   └── images/
│       ├── logo.png
│       └── icons/
├── 📚 data/                     # 데이터 파일
│   ├── gep_master.xlsx         # 기존 GEP 마스터 데이터
│   ├── questions.json          # 변환된 문제 데이터
│   └── user_data/              # 사용자 데이터 폴더
├── 🧪 tests/                    # 테스트 파일
│   ├── __init__.py
│   ├── test_services.py        # 서비스 테스트 (150줄 이하)
│   ├── test_routes.py          # 라우트 테스트 (150줄 이하)
│   └── test_utils.py           # 유틸리티 테스트 (100줄 이하)
├── 🔧 utils/                    # 유틸리티 함수
│   ├── __init__.py
│   ├── data_converter.py       # 데이터 변환 유틸 (150줄 이하)
│   ├── auth_utils.py           # 인증 유틸리티 (100줄 이하)
│   └── validation.py           # 데이터 검증 (100줄 이하)
├── ⚙️ config/                   # 설정 파일
│   ├── __init__.py
│   ├── settings.py             # 기본 설정 (100줄 이하)
│   ├── database.py             # 데이터베이스 설정 (50줄 이하)
│   └── services.py             # 서비스 설정 (50줄 이하)
└── 📖 docs/                     # 문서
    ├── api_docs.md             # API 문서
    ├── setup_guide.md          # 설치 가이드
    └── development_guide.md    # 개발 가이드
```

---

## 🔧 핵심 모듈 설계 (레고블록 방식)

### **1. 서비스 레이어 (services/)**

#### 1.1 QuestionService (문제 관리)
```python
# services/question_service.py (200줄 이하)
class QuestionService:
    """문제 관리 서비스 - 레고블록 1"""
    
    def __init__(self, db_connection):
        self.db = db_connection
    
    def get_questions_by_round(self, round_number):
        """회차별 문제 조회 - 재사용 가능한 함수"""
        return self._filter_questions({'eround': round_number})
    
    def get_questions_by_subject(self, subject):
        """과목별 문제 조회 - 재사용 가능한 함수"""
        return self._filter_questions({'layer1': subject})
    
    def get_questions_by_difficulty(self, difficulty):
        """난이도별 문제 조회 - 재사용 가능한 함수"""
        return self._filter_questions({'difficulty': difficulty})
    
    def _filter_questions(self, filters):
        """공통 필터링 로직 - 재사용 극대화"""
        # 단일 함수로 모든 필터링 처리
        pass
    
    def get_random_questions(self, count, filters=None):
        """랜덤 문제 조회 - 진위형 문제용"""
        pass
    
    def validate_question_format(self, question_data):
        """문제 형식 검증 - 재사용 가능한 함수"""
        pass
```

#### 1.2 UserService (사용자 관리)
```python
# services/user_service.py (200줄 이하)
class UserService:
    """사용자 관리 서비스 - 레고블록 2"""
    
    def __init__(self, db_connection):
        self.db = db_connection
    
    def create_user(self, user_data):
        """사용자 생성 - 재사용 가능한 함수"""
        return self._save_user(user_data)
    
    def update_user_level(self, user_id, new_level):
        """서비스 레벨 업데이트 - 재사용 가능한 함수"""
        return self._update_user_field(user_id, 'subscription_level', new_level)
    
    def get_user_progress(self, user_id):
        """사용자 진행상황 조회 - 재사용 가능한 함수"""
        return self._get_user_data(user_id, 'progress')
    
    def _save_user(self, user_data):
        """공통 저장 로직 - 재사용 극대화"""
        pass
    
    def _update_user_field(self, user_id, field, value):
        """공통 업데이트 로직 - 재사용 극대화"""
        pass
```

#### 1.3 StatsService (통계 관리)
```python
# services/stats_service.py (200줄 이하)
class StatsService:
    """통계 관리 서비스 - 레고블록 3"""
    
    def __init__(self, db_connection):
        self.db = db_connection
    
    def record_answer(self, user_id, question_id, answer, is_correct):
        """답안 기록 - 재사용 가능한 함수"""
        return self._save_activity(user_id, question_id, answer, is_correct)
    
    def get_user_stats(self, user_id):
        """사용자 통계 조회 - 재사용 가능한 함수"""
        return self._calculate_stats(user_id)
    
    def get_subject_stats(self, user_id, subject):
        """과목별 통계 - 재사용 가능한 함수"""
        return self._calculate_stats(user_id, {'subject': subject})
    
    def get_daily_stats(self, user_id, date):
        """일별 통계 - 재사용 가능한 함수"""
        return self._calculate_stats(user_id, {'date': date})
    
    def _save_activity(self, user_id, question_id, answer, is_correct):
        """공통 활동 저장 로직 - 재사용 극대화"""
        pass
    
    def _calculate_stats(self, user_id, filters=None):
        """공통 통계 계산 로직 - 재사용 극대화"""
        pass
```

### **2. 라우트 레이어 (routes/)**

#### 2.1 QuestionRoutes (문제 API)
```python
# routes/question_routes.py (150줄 이하)
from flask import Blueprint, jsonify, request
from services.question_service import QuestionService

question_bp = Blueprint('question', __name__)

@question_bp.route('/api/questions/round/<int:round_number>')
def get_questions_by_round(round_number):
    """회차별 문제 조회 API - 재사용 가능한 엔드포인트"""
    service = QuestionService(get_db_connection())
    questions = service.get_questions_by_round(round_number)
    return jsonify({'success': True, 'data': questions})

@question_bp.route('/api/questions/subject/<subject>')
def get_questions_by_subject(subject):
    """과목별 문제 조회 API - 재사용 가능한 엔드포인트"""
    service = QuestionService(get_db_connection())
    questions = service.get_questions_by_subject(subject)
    return jsonify({'success': True, 'data': questions})

@question_bp.route('/api/questions/random')
def get_random_questions():
    """랜덤 문제 조회 API - 진위형 문제용"""
    count = request.args.get('count', 10, type=int)
    service = QuestionService(get_db_connection())
    questions = service.get_random_questions(count)
    return jsonify({'success': True, 'data': questions})
```

#### 2.2 UserRoutes (사용자 API)
```python
# routes/user_routes.py (150줄 이하)
from flask import Blueprint, jsonify, request
from services.user_service import UserService

user_bp = Blueprint('user', __name__)

@user_bp.route('/api/user/register', methods=['POST'])
def register_user():
    """사용자 등록 API - 재사용 가능한 엔드포인트"""
    user_data = request.get_json()
    service = UserService(get_db_connection())
    result = service.create_user(user_data)
    return jsonify({'success': True, 'data': result})

@user_bp.route('/api/user/<int:user_id>/upgrade', methods=['PUT'])
def upgrade_user(user_id):
    """사용자 업그레이드 API - 재사용 가능한 엔드포인트"""
    new_level = request.json.get('level')
    service = UserService(get_db_connection())
    result = service.update_user_level(user_id, new_level)
    return jsonify({'success': True, 'data': result})
```

### **3. 유틸리티 레이어 (utils/)**

#### 3.1 DataConverter (데이터 변환)
```python
# utils/data_converter.py (150줄 이하)
class DataConverter:
    """데이터 변환 유틸리티 - 레고블록 4"""
    
    @staticmethod
    def excel_to_json(excel_file, output_file):
        """Excel to JSON 변환 - 재사용 가능한 함수"""
        return DataConverter._convert_format(excel_file, 'excel', 'json', output_file)
    
    @staticmethod
    def json_to_database(json_file, db_connection):
        """JSON to Database 변환 - 재사용 가능한 함수"""
        return DataConverter._convert_format(json_file, 'json', 'database', db_connection)
    
    @staticmethod
    def validate_question_data(question_data):
        """문제 데이터 검증 - 재사용 가능한 함수"""
        return DataConverter._validate_data(question_data, 'question')
    
    @staticmethod
    def _convert_format(input_file, input_format, output_format, output_target):
        """공통 변환 로직 - 재사용 극대화"""
        pass
    
    @staticmethod
    def _validate_data(data, data_type):
        """공통 검증 로직 - 재사용 극대화"""
        pass
```

#### 3.2 AuthUtils (인증 유틸리티)
```python
# utils/auth_utils.py (100줄 이하)
class AuthUtils:
    """인증 유틸리티 - 레고블록 5"""
    
    @staticmethod
    def generate_guest_id():
        """게스트 ID 생성 - 재사용 가능한 함수"""
        return f"guest_{int(time.time())}"
    
    @staticmethod
    def validate_user_permission(user_id, required_level):
        """사용자 권한 검증 - 재사용 가능한 함수"""
        return AuthUtils._check_permission(user_id, required_level)
    
    @staticmethod
    def create_session_data(user_data):
        """세션 데이터 생성 - 재사용 가능한 함수"""
        return AuthUtils._format_session_data(user_data)
    
    @staticmethod
    def _check_permission(user_id, required_level):
        """공통 권한 검증 로직 - 재사용 극대화"""
        pass
```

---

## 🔄 모듈 간 의존성 관리

### **1. 의존성 주입 패턴**
```python
# config/services.py (50줄 이하)
class ServiceContainer:
    """서비스 컨테이너 - 의존성 관리"""
    
    def __init__(self):
        self.db_connection = self._create_db_connection()
        self.question_service = QuestionService(self.db_connection)
        self.user_service = UserService(self.db_connection)
        self.stats_service = StatsService(self.db_connection)
    
    def get_question_service(self):
        return self.question_service
    
    def get_user_service(self):
        return self.user_service
    
    def get_stats_service(self):
        return self.stats_service
```

### **2. 공통 함수 재사용**
```python
# utils/common.py (100줄 이하)
class CommonUtils:
    """공통 유틸리티 - 재사용 극대화"""
    
    @staticmethod
    def format_response(success, data=None, message=""):
        """응답 형식 통일 - 모든 API에서 재사용"""
        return {
            'success': success,
            'data': data,
            'message': message,
            'timestamp': datetime.now().isoformat()
        }
    
    @staticmethod
    def validate_required_fields(data, required_fields):
        """필수 필드 검증 - 모든 서비스에서 재사용"""
        missing_fields = [field for field in required_fields if field not in data]
        return len(missing_fields) == 0, missing_fields
    
    @staticmethod
    def log_activity(activity_type, user_id, details):
        """활동 로깅 - 모든 서비스에서 재사용"""
        pass
```

---

## 📊 파일 크기 제한 및 품질 관리

### **1. 파일 크기 제한**
```python
# 개발 원칙: 모든 파일 200줄 이하
MAX_FILE_LINES = 200
MAX_FUNCTION_LINES = 50
MAX_CLASS_LINES = 150

# 파일 크기 검증 스크립트
def validate_file_size(file_path):
    """파일 크기 검증 - 개발 품질 관리"""
    with open(file_path, 'r', encoding='utf-8') as f:
        lines = f.readlines()
        if len(lines) > MAX_FILE_LINES:
            print(f"⚠️ {file_path}: {len(lines)}줄 (제한: {MAX_FILE_LINES}줄)")
            return False
    return True
```

### **2. 함수 재사용률 측정**
```python
# 재사용률 측정 스크립트
def measure_reuse_rate():
    """함수 재사용률 측정 - 레고블록 효과 검증"""
    reuse_stats = {
        'total_functions': 0,
        'reused_functions': 0,
        'reuse_rate': 0.0
    }
    # 재사용률 계산 로직
    return reuse_stats
```

---

## 🚀 확장성 고려사항

### **1. 새로운 시험 추가**
```python
# 새로운 시험 추가 시 확장 구조
def add_new_exam(exam_config):
    """새로운 시험 추가 - 기존 구조 활용"""
    # 1. 데이터베이스에 시험 정보 추가
    # 2. 기존 서비스 재사용 (QuestionService, StatsService)
    # 3. 새로운 라우트 추가 (기존 패턴 활용)
    # 4. UI 템플릿 확장 (기존 컴포넌트 재사용)
    pass
```

### **2. 새로운 기능 추가**
```python
# 새로운 기능 추가 시 확장 구조
def add_new_feature(feature_config):
    """새로운 기능 추가 - 기존 구조 활용"""
    # 1. 새로운 서비스 클래스 생성 (기존 패턴 활용)
    # 2. 새로운 라우트 추가 (기존 패턴 활용)
    # 3. 기존 유틸리티 함수 재사용
    # 4. UI 컴포넌트 확장 (기존 스타일 활용)
    pass
```

---

## 📈 성공 지표

### **1. 코드 품질 지표**
- **파일 크기**: 모든 파일 200줄 이하 유지
- **함수 재사용률**: 70% 이상 달성
- **의존성 복잡도**: 최소화 유지

### **2. 개발 효율성 지표**
- **새 기능 추가 시간**: 기존 구조 활용으로 50% 단축
- **버그 발생률**: 모듈화로 30% 감소
- **유지보수 시간**: 구조화로 40% 단축

---

## 🚀 다음 단계

### **폴더 구조 설계 완성 후**
1. **핵심 함수 설계**: 각 모듈의 세부 함수 설계
2. **데이터베이스 스키마**: 3개 테이블 상세 설계
3. **API 설계**: RESTful API 엔드포인트 설계

---

**작성자**: AI Assistant (Seo Daeri)  
**작성일**: 2024-12-19  
**문서 번호**: 016_GEP_V1.0_2.2_단순한폴더구조
