# G048 QCODE 생성 원칙 최종 가이드라인

## 📋 문서 정보

**문서 번호**: G048  
**제목**: QCODE 생성 원칙 최종 가이드라인  
**작성일**: 2025년 8월 30일  
**작성자**: 서대리 (Cursor AI)  
**검토자**: 조대표님  
**버전**: V1.0  
**상태**: 최종 확정  
**중요도**: ⭐⭐⭐⭐⭐ (최고 중요 - 모든 개발의 기준)

---

## 🎯 개요

본 문서는 GEP(손해보험중개사) 시스템에서 사용하는 **QCODE(Question Code) 생성 원칙**을 정의합니다. 이 원칙은 향후 모든 새로운 레코드 생성 시 반드시 준수해야 하는 **절대적 기준**입니다.

### **핵심 원칙**
- **QUESTION 필드 완전 노터치**: 문제 데이터의 완결성 보장
- **부모-자식 관계 추적**: 문제 출처의 명확한 식별
- **EROUND 정보 포함**: 회차별 문제 관리
- **중복 방지**: 고유한 식별자 보장

---

## 📊 QCODE 구조 정의

### **1. 기본 QCODE 구조**

```
ABCD-XX
```

**구성 요소**:
- `ABCD`: 시험종류 + 중분류 + LAYER1 + QTYPE (6자리)
- `-`: 구분자
- `XX`: 순차번호 (2자리)

### **2. 상세 구성 요소**

| 위치 | 길이 | 의미 | 예시 | 설명 |
|------|------|------|------|------|
| 1-2 | 2자리 | 시험종류 | AB | 손해보험중개사 |
| 3-4 | 2자리 | 중분류 | 20 | 20회차 |
| 5-6 | 2자리 | LAYER1 + QTYPE | AA | 관계법령 + A타입 |

### **3. EROUND 정보**

**중요**: `ABCD`의 3-4번째 자리는 **EROUND(회차)** 정보를 나타냅니다.

| EROUND | QCODE 예시 | 설명 |
|--------|------------|------|
| 20회차 | AB20AA-01 | 20회차 관계법령 1번 문제 |
| 21회차 | AB21AA-01 | 21회차 관계법령 1번 문제 |
| 22회차 | AB22AA-01 | 22회차 관계법령 1번 문제 |

---

## 🔄 QCODE 유형별 생성 규칙

### **1. 객관식 문제 (Master Questions)**

**형식**: `ABCD-XX`

**예시**:
- `AB20AA-01`: 20회차 관계법령 1번 문제
- `AB21BA-15`: 21회차 손보1부 15번 문제
- `AB22CA-30`: 22회차 손보2부 30번 문제

**생성 규칙**:
1. EROUND 정보를 3-4번째 자리에 반드시 포함
2. LAYER1과 QTYPE을 조합하여 5-6번째 자리 결정
3. 순차번호는 01부터 시작하여 2자리로 표기

### **2. 진위형 문제 (True/False Questions)**

**형식**: `ABCD-XX-BY`

**구성 요소**:
- `ABCD-XX`: 부모 객관식 문제의 QCODE
- `-`: 구분자
- `BY`: 슬롯 번호 (B1, B2, ..., B8)

**예시**:
- `AB20AA-01-B1`: AB20AA-01에서 생성된 1번 진위형 문제
- `AB20AA-01-B2`: AB20AA-01에서 생성된 2번 진위형 문제
- `AB21BA-15-B3`: AB21BA-15에서 생성된 3번 진위형 문제

**생성 규칙**:
1. **반드시 부모 객관식 문제의 QCODE를 기반으로 생성**
2. 부모 QCODE 뒤에 `-BY` 형태로 슬롯 번호 추가
3. 슬롯 번호는 B1부터 B8까지 순차적으로 할당
4. 부모 문제 출처 추적이 가능해야 함

---

## 🚨 절대 준수 사항

### **1. QUESTION 필드 완전 노터치**

```
❌ 금지 사항:
- QUESTION 필드 분석
- QUESTION 필드 수정
- QUESTION 필드 파싱
- QUESTION 필드 내용 변경

✅ 허용 사항:
- QUESTION 필드 읽기
- QUESTION 필드 표시
- QUESTION 필드 복사
```

**이유**: QUESTION 필드의 완결성이 시스템의 심장이므로, 어떤 경우에도 내용을 변경하면 안 됩니다.

### **2. EROUND 정보 필수 포함**

```
❌ 잘못된 예시:
- ABAA-01 (EROUND 정보 누락)
- ABBA-15 (EROUND 정보 누락)

✅ 올바른 예시:
- AB20AA-01 (20회차 포함)
- AB21BA-15 (21회차 포함)
```

### **3. 부모-자식 관계 명확화**

```
✅ 올바른 관계:
부모: AB20AA-01 (객관식)
자식: AB20AA-01-B1, AB20AA-01-B2, ... (진위형)

❌ 잘못된 관계:
부모: AB20AA-01
자식: ABAA-01-B1 (부모 정보 불일치)
```

### **4. 중복 방지**

```
✅ 고유성 보장:
- 모든 QCODE는 시스템 내에서 고유해야 함
- 동일한 QCODE가 2개 이상 존재하면 안 됨
- 생성 전 중복 검증 필수
```

---

## 📁 파일별 QCODE 관리

### **1. 문제제이슨 파일** (`gep_master_v1.0.json`)

**역할**: 객관식 문제의 마스터 데이터
**QCODE 형식**: `ABCD-XX`
**레코드 수**: 1440개
**중요도**: 모든 QCODE의 기준점

### **2. 작업용엑셀 파일** (`GEP_MASTER_V1.0(LAYER2포함).xlsx`)

**역할**: 작업용 데이터
**QCODE 형식**: 문제제이슨과 완전 동일
**동기화**: 문제제이슨과 100% 일치해야 함

### **3. Q매니저 파일** (`qmanager_questions.json`)

**역할**: 진위형 문제 관리
**부모 QCODE**: `ABCD-XX` (객관식 문제)
**자식 QCODE**: `ABCD-XX-BY` (진위형 문제)
**관계**: 부모-자식 관계 명확히 추적

---

## 🔧 QCODE 생성 프로세스

### **1. 새로운 객관식 문제 생성 시**

```python
def generate_master_qcode(eround, layer1, qtype, sequence):
    """
    객관식 문제 QCODE 생성
    
    Args:
        eround (str): 회차 (예: "20", "21", "22")
        layer1 (str): LAYER1 (예: "A", "B", "C")
        qtype (str): QTYPE (예: "A", "B")
        sequence (int): 순차번호 (1-99)
    
    Returns:
        str: QCODE (예: "AB20AA-01")
    """
    # 시험종류 (고정값)
    exam_type = "AB"
    
    # 중분류 (EROUND)
    category = eround
    
    # LAYER1 + QTYPE 조합
    layer_qtype = layer1 + qtype
    
    # 순차번호 (2자리)
    seq_num = f"{sequence:02d}"
    
    # QCODE 조합
    qcode = f"{exam_type}{category}{layer_qtype}-{seq_num}"
    
    return qcode
```

### **2. 새로운 진위형 문제 생성 시**

```python
def generate_derived_qcode(parent_qcode, slot_number):
    """
    진위형 문제 QCODE 생성
    
    Args:
        parent_qcode (str): 부모 객관식 문제 QCODE
        slot_number (int): 슬롯 번호 (1-8)
    
    Returns:
        str: 진위형 QCODE (예: "AB20AA-01-B1")
    """
    # 슬롯 번호를 B 형태로 변환
    slot = f"B{slot_number}"
    
    # 부모 QCODE + 슬롯 번호
    derived_qcode = f"{parent_qcode}-{slot}"
    
    return derived_qcode
```

---

## ✅ 검증 체크리스트

### **QCODE 생성 전 검증**

- [ ] EROUND 정보가 포함되었는가?
- [ ] 부모-자식 관계가 명확한가?
- [ ] 중복되지 않는가?
- [ ] 형식이 올바른가?

### **QCODE 생성 후 검증**

- [ ] 모든 파일에서 동일한 QCODE를 사용하는가?
- [ ] 부모 문제 출처를 추적할 수 있는가?
- [ ] QUESTION 필드가 변경되지 않았는가?
- [ ] 레코드 수가 일치하는가?

---

## 🚫 금지 사항

### **1. QCODE 생성 시 금지**

- ❌ EROUND 정보 누락
- ❌ 부모 QCODE와 불일치하는 자식 QCODE 생성
- ❌ 중복 QCODE 생성
- ❌ 형식에 맞지 않는 QCODE 생성

### **2. 데이터 처리 시 금지**

- ❌ QUESTION 필드 수정
- ❌ 기존 QCODE 변경
- ❌ 부모-자식 관계 파괴
- ❌ 파일 간 QCODE 불일치

---

## 📚 참고 문서

- **G024**: QCODE 매핑 가이드 (이전 버전)
- **G047**: QManager 진위형 문제 관리 시스템 개발 완료 보고서
- **G052**: 3단계 LAYER2 과목별 기출문제 풀기 기능 세부개발계획서

---

## 🔄 버전 관리

| 버전 | 날짜 | 변경 사항 | 작성자 |
|------|------|-----------|--------|
| V1.0 | 2025-08-30 | 최초 작성, 최종 확정 | 서대리 |

---

## 🎯 결론

본 가이드라인은 GEP 시스템의 **모든 QCODE 생성의 절대적 기준**입니다. 향후 어떤 브랜치에서 개발하더라도, 새로운 레코드를 생성할 때는 반드시 이 원칙을 준수해야 합니다.

**핵심 메시지**:
1. **QUESTION 필드 완전 노터치** - 데이터 완결성 보장
2. **EROUND 정보 필수 포함** - 회차별 관리
3. **부모-자식 관계 명확화** - 출처 추적
4. **중복 방지** - 고유성 보장

이 원칙을 준수하면 GEP 시스템의 데이터 무결성과 일관성을 완벽하게 유지할 수 있습니다.

---

**문서 작성 완료**: 2025년 8월 30일  
**최종 검토**: 조대표님  
**적용 범위**: 모든 GEP 시스템 개발  
**중요도**: ⭐⭐⭐⭐⭐ (최고 중요)
