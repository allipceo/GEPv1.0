# QCODE 매핑 가이드 v3.0 (AB20AA 체계 전면 개정)

## 📋 **문서 개요**
- **작성일**: 2025년 8월 29일
- **버전**: v3.0 (AB20AA 체계 전면 개정)
- **상태**: 회차별 구분이 명확한 새로운 QCODE 체계 적용
- **적용 범위**: 기본서비스, 고급서비스, 모든 GEP 시스템

---

## 🎯 **새로운 QCODE 체계 표준 (AB20AA 기반)**

### **기본 구성 규칙**

QCODE는 두 가지 형태로 구성됩니다:

#### **1. 기출문제 QCODE (기본)**
- **형식**: `ABXXAA-XX` (회차별 구분)
- **A**: 시험종류 (A:보험중개사, B:보험심사역, C:손해사정사)
- **B**: 중분류 (A:생명보험, B:손해보험, C:제3보험)
- **XX**: 회차 (20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30...)
- **A**: LAYER1 (A:관계법령, B:손보1부, C:손보2부)
- **A**: QTYPE (A:기출문제, B:진위형)
- **XX**: 순차번호 (01, 02, 03...)

#### **2. 진위형 문제 QCODE (파생)**
- **형식**: `원본QCODE-B슬롯번호`
- **원본QCODE**: 기출문제의 QCODE (AB20AA-01 형태)
- **B**: 진위형 문제 식별자
- **슬롯번호**: 1~8 (8개 고정 슬롯 시스템)

---

## 📊 **매핑 테이블**

### **시험종류**
- 보험중개사: A
- 보험심사역: B
- 손해사정사: C

### **중분류**
- 생명보험: A
- 손해보험: B
- 제3보험: C

### **회차**
- 20회: 20
- 21회: 21
- 22회: 22
- 23회: 23
- 24회: 24
- 25회: 25
- 26회: 26
- 27회: 27
- 28회: 28
- 29회: 29
- 30회: 30
- 31회: 31 (향후 확장)
- 32회: 32 (향후 확장)

### **LAYER1**
- 관계법령: A
- 손보1부: B
- 손보2부: C

### **QTYPE**
- A: 기출문제(선택형)
- B: 진위형

---

## 🔗 **QCODE 예시**

### **기출문제 QCODE (새로운 체계)**
- **AB20AA-01**: 20회 보험중개사-손해보험-관계법령-기출문제-01번
- **AB20AA-02**: 20회 보험중개사-손해보험-관계법령-기출문제-02번
- **AB21AA-01**: 21회 보험중개사-손해보험-관계법령-기출문제-01번
- **AB22AA-01**: 22회 보험중개사-손해보험-관계법령-기출문제-01번
- **AB30AA-01**: 30회 보험중개사-손해보험-관계법령-기출문제-01번
- **AB20BA-01**: 20회 보험중개사-손해보험-손보1부-기출문제-01번
- **AB20CA-01**: 20회 보험중개사-손해보험-손보2부-기출문제-01번

### **진위형 문제 QCODE (Q매니저 체계)**
- **AB20AA-01-B1**: 20회 관계법령 1번 기출문제의 1번 진위형 문제
- **AB20AA-01-B2**: 20회 관계법령 1번 기출문제의 2번 진위형 문제
- **AB21AA-01-B1**: 21회 관계법령 1번 기출문제의 1번 진위형 문제
- **AB30AA-01-B1**: 30회 관계법령 1번 기출문제의 1번 진위형 문제

---

## 🏗️ **8개 고정 슬롯 시스템 (Q매니저 표준)**

### **슬롯 구조**
각 기출문제당 정확히 8개의 고정 슬롯을 가집니다:

```json
{
  "AB20AA-01": {
    "source_qcode": "AB20AA-01",
    "slots": {
      "B1": { "question": "...", "answer": "O", "exists": true },
      "B2": { "question": "...", "answer": "X", "exists": true },
      "B3": { "question": "...", "answer": "O", "exists": true },
      "B4": { "question": "...", "answer": "X", "exists": true },
      "B5": { "question": "...", "answer": "O", "exists": true },
      "B6": { "question": "...", "answer": "O", "exists": true },
      "B7": { "question": "...", "answer": "X", "exists": true },
      "B8": { "question": "", "answer": "", "exists": false }
    }
  }
}
```

### **슬롯 특징**
- **고정 슬롯**: 모든 기출문제가 정확히 8개 슬롯 보유
- **유연한 사용**: 필요한 만큼만 사용 (1~8개)
- **확장 가능**: 필요시 B9, B10... 추가 가능
- **데이터 무결성**: 슬롯 번호 순차적 할당

---

## 🔄 **기출문제 기반 진위형 문제 생성 워크플로우**

### **1. 진위형 문제 QCODE 생성 규칙**

#### **Q매니저 파생형 QCODE 구조**
```
[원본 기출문제 QCODE]-B[슬롯번호]
```

#### **실제 구현 예시**
- **원본 기출문제**: `AB20AA-01` (20회 관계법령 1번)
- **파생 진위형 문제들**:
  - `AB20AA-01-B1`: 20회 관계법령 1번의 1번 슬롯
  - `AB20AA-01-B2`: 20회 관계법령 1번의 2번 슬롯
  - `AB20AA-01-B3`: 20회 관계법령 1번의 3번 슬롯
  - `AB20AA-01-B8`: 20회 관계법령 1번의 8번 슬롯

### **2. 작업 프로세스 (Q매니저 검증된 방식)**

#### **2.1 사용자 작업 (Q매니저 UI)**
1. **기출문제 선택**: 좌측 목록에서 기출문제 선택
2. **8개 슬롯 표시**: 우측에 8개 고정 슬롯 표시
3. **진위형 문제 작성**:
   - QUESTION: 진위형 문제 문장
   - ANSWER: "O" 또는 "X"
   - 슬롯별 개별 입력 및 관리
4. **실시간 저장**: 각 슬롯별 실시간 저장

#### **2.2 시스템 처리 (Q매니저 자동화)**
1. **QCODE 자동 생성**: 원본QCODE-B슬롯번호 형태
2. **데이터 보완**:
   - ETITLE, ECLASS, EROUND, LAYER1, LAYER2: 원본 복사
   - QNUM: 원본 QNUM + "-B" + 슬롯번호
   - CREATED_DATE, MODIFIED_DATE: 현재 시간
3. **JSON 업데이트**: qmanager_questions.json에 저장

### **3. 데이터 매핑 규칙 (Q매니저 실제 구현)**

#### **원본에서 복사되는 필드**
- ETITLE: 보험중개사
- ECLASS: 손해보험
- EROUND: 20.0
- LAYER1: 관계법령
- LAYER2: 보험업법
- LAYER3: (빈 값)
- DIFFICULTY: (빈 값)

#### **새로 생성되는 필드**
- QCODE: `AB20AA-01-B1`, `AB20AA-01-B2`, ...
- QTYPE: "B" (진위형)
- QNUM: "1-B1", "1-B2", ...
- CREATED_DATE: 현재 날짜
- MODIFIED_DATE: 현재 날짜

### **4. 실제 데이터 예시 (Q매니저 구현)**

#### **원본 기출문제**
```json
{
  "QCODE": "AB20AA-01",
  "QTYPE": "A",
  "QUESTION": "보험업법의내용과관련하여타당하지않은것은?",
  "ANSWER": "2"
}
```

#### **파생 진위형 문제들 (Q매니저 실제 데이터)**
```json
{
  "AB20AA-01-B1": {
    "question": "보험중개사 시험은 손해보험 분야의 시험이다.",
    "answer": "O",
    "original_qcode": "AB20AA-01-B1",
    "parent_info": "20.0회 관계법령 1번"
  },
  "AB20AA-01-B2": {
    "question": "20.0회 시험의 관계법령 과목은 1번 문제가 있다.",
    "answer": "O",
    "original_qcode": "AB20AA-01-B2",
    "parent_info": "20.0회 관계법령 1번"
  }
}
```

---

## 📈 **현재 구현 현황 (AB20AA 체계 기준)**

### **데이터 현황**
- **총 기출문제 수**: 1,440개 (20회~30회, 11년치)
- **회차별 분포**:
  - 20회: 160개, 21회: 160개, 22회: 160개
  - 23회~30회: 각 120개씩
- **진위형 문제 생성**: 60개 기출문제에 대해 진행
- **총 진위형 문제 수**: 약 300개 (평균 5개/기출문제)
- **QCODE 체계**: 100% AB20AA 방식 적용

### **파일 구조**
- **기출문제**: `static/data/gep_master_v1.0.json`
- **진위형 문제**: `static/data/qmanager_questions.json`
- **구조 정의**: `static/data/qmanager_structure.json`

### **고유성 보장**
- **기존 QCODE**: 1,440개 (기출문제) - 100% 고유
- **신규 QCODE**: 파생형으로 생성하여 충돌 방지
- **총 고유 QCODE**: 기존 + 신규 (확장 가능)

---

## 🔗 **기본서비스-고급서비스 연동**

### **QCODE 기반 연동 로직**

#### **기본서비스에서 기출문제 선택 시**
```python
# 사용자가 AB20AA-01 선택
기본서비스: "AB20AA-01 기출문제 표시"
고급서비스: "AB20AA-01-B1, B2, B3... 진위형 문제 검색"
# → 완벽한 1:1 매칭
```

#### **진위형 문제 생성 시**
```python
# 사용자가 AB20AA-01에 진위형 문제 추가
Q매니저: "B4 슬롯에 저장" → AB20AA-01-B4
# → 모든 서비스에서 동일한 QCODE 사용
```

#### **데이터 통합 시**
```python
# 기본서비스 + 고급서비스 통합
기출문제: AB20AA-01
진위형 문제: AB20AA-01-B1, AB20AA-01-B2, AB20AA-01-B3...
# → QCODE 기반 완벽 연동
```

---

## 🎯 **새로운 체계의 우수성**

### **기술적 효과**
- ✅ **완벽한 고유성**: 회차별 구분으로 중복 불가능
- ✅ **확장성**: 새로운 회차 추가 시 자동 고유성 보장
- ✅ **데이터 무결성**: 단일 QCODE 체계로 충돌 방지
- ✅ **개발 효율성**: 검증된 Q매니저 시스템 재활용
- ✅ **유지보수성**: 일관된 구조로 관리 용이

### **사용자 경험 효과**
- ✅ **직관적 이해**: 회차별 명확한 구분
- ✅ **일관된 경험**: 모든 서비스에서 동일한 QCODE 체계
- ✅ **안정적 서비스**: 검증된 Q매니저 시스템으로 안정성 보장
- ✅ **확장 가능**: 31회, 32회 등 새로운 회차 자동 지원

### **향후 확장성**
```python
# 새로운 회차 추가 시 자동 고유성 보장
AB31AA-01: 31회 관계법령 1번
AB32AA-01: 32회 관계법령 1번
AB33AA-01: 33회 관계법령 1번
# → 기존 QCODE와 완전히 구분됨
```

---

## 📝 **업데이트 이력**

- **2025-01-17**: QCODE 중복 문제 해결
- **2025-01-17**: 모든 문제에 고유한 QCODE 부여
- **2025-01-17**: 엑셀, CSV, JSON 파일 동기화 완료
- **2025-08-26**: 기출문제 기반 진위형 문제 생성 워크플로우 추가
- **2025-08-29**: Q매니저 체계로 일원화 완료 (v2.0)
- **2025-08-29**: AB20AA 체계로 전면 개정 완료 (v3.0)

---

## 🏁 **결론**

**AB20AA QCODE 체계를 GEP 시스템의 새로운 표준으로 채택**하여:

1. **완벽한 고유성**: 회차별 구분으로 중복 불가능
2. **확장성**: 새로운 회차 추가 시 자동 고유성 보장
3. **실용적 구조**: 8개 고정 슬롯으로 실용적이고 확장 가능한 구조
4. **완벽한 연동**: 기본서비스와 고급서비스의 유기적 연동 보장
5. **일관된 표준**: 모든 GEP 시스템에서 동일한 QCODE 체계 사용

**이제 기본서비스와 고급서비스 개발 시 AB20AA QCODE 체계를 표준으로 사용하여 안정적이고 확장 가능한 시스템을 구축할 수 있습니다.**

---

**문서 버전**: v3.0 (AB20AA 체계 전면 개정)  
**최종 수정일**: 2025년 8월 29일  
**승인자**: 조대표님  
**적용 범위**: 모든 GEP 시스템
