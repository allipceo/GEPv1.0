# 131. κ²μ¤νΈλ“±λ΅ μ‹¤ν¨ λ¬Έμ  λ°κ²¬ λ° ν•΄κ²° λ³΄κ³ μ„

## π“ λ¬Έμ  λ°κ²¬ λ° ν•΄κ²° κ³Όμ •

**λ°κ²¬ μΌμ‹**: 2025-08-22  
**λ¬Έμ  μ ν•**: API μ—”λ“ν¬μΈνΈ λ„λ½ λ° μ½”λ“ μ¤λ¥  
**ν•΄κ²° μƒνƒ**: β… **μ™„λ£**

---

## π¨ λ°κ²¬λ λ¬Έμ 

### **μ‚¬μ©μ λ³΄κ³ **
- **λ¬Έμ **: μ΄κΈ°ν™”λ©΄μ—μ„ κ²μ¤νΈλ΅ λ“±λ΅ν–λ”λ‹ μ‹¤ν¨ν™”λ©΄μ΄ λΈ
- **μ¤λ¥ λ©”μ‹μ§€**: "κ²μ¤νΈ λ“±λ΅μ— μ‹¤ν¨ν–μµλ‹λ‹¤."
- **λ°μƒ μ„μΉ**: μ‚¬μ©μ λ“±λ΅ νμ΄μ§€ (`/register`)

### **λ¬Έμ  λ¶„μ„ κ²°κ³Ό**

#### **1. λ„λ½λ API μ—”λ“ν¬μΈνΈ**
- **λ¬Έμ **: `templates/user_registration.html`μ—μ„ `/api/register/guest` μ—”λ“ν¬μΈνΈ νΈμ¶
- **ν„μ‹¤**: `app_v4.12.py`μ—λ” ν•΄λ‹Ή μ—”λ“ν¬μΈνΈκ°€ μ •μλμ§€ μ•μ
- **κ²°κ³Ό**: 404 μ¤λ¥λ΅ μΈν• λ“±λ΅ μ‹¤ν¨

#### **2. μλ»λ datetime λ©”μ„λ“ μ‚¬μ©**
- **λ¬Έμ **: Python `datetime` κ°μ²΄μ—μ„ `toISOString()` λ©”μ„λ“ μ‚¬μ©
- **μ¤λ¥**: `'datetime.datetime' object has no attribute 'toISOString'`
- **μ›μΈ**: JavaScript λ©”μ„λ“λ¥Ό Pythonμ—μ„ μ‚¬μ©ν•λ ¤κ³  μ‹λ„

#### **3. μλ»λ ν™νμ΄μ§€ κ²½λ΅**
- **λ¬Έμ **: λ“±λ΅ μ™„λ£ ν›„ `/home`μΌλ΅ μ΄λ™ μ‹λ„
- **ν„μ‹¤**: μ¬λ°”λ¥Έ ν™νμ΄μ§€ κ²½λ΅λ” `/`
- **κ²°κ³Ό**: λ“±λ΅ ν›„ νμ΄μ§€ μ΄λ™ μ‹¤ν¨

---

## π” λ¬Έμ  μ§„λ‹¨ κ³Όμ •

### **1λ‹¨κ³„: μ½”λ“ λ¶„μ„**
```bash
# μ‚¬μ©μ λ“±λ΅ νμ΄μ§€ λ¶„μ„
templates/user_registration.html β†’ /api/register/guest νΈμ¶ ν™•μΈ

# μ„λ²„ μ½”λ“ λ¶„μ„  
app_v4.12.py β†’ λ„λ½λ μ—”λ“ν¬μΈνΈ ν™•μΈ
```

### **2λ‹¨κ³„: API ν…μ¤νΈ**
```python
# ν…μ¤νΈ μ¤ν¬λ¦½νΈ μƒμ„± λ° μ‹¤ν–‰
test_guest_registration.py

# κ²°κ³Ό: 404 μ¤λ¥ λ° datetime λ©”μ„λ“ μ¤λ¥ ν™•μΈ
```

### **3λ‹¨κ³„: μ¤λ¥ λ΅κ·Έ λ¶„μ„**
```
μ¤λ¥ λ©”μ‹μ§€: 'datetime.datetime' object has no attribute 'toISOString'
μ›μΈ: JavaScript λ©”μ„λ“λ¥Ό Pythonμ—μ„ μ‚¬μ©
```

---

## π› οΈ ν•΄κ²° κ³Όμ •

### **1. API μ—”λ“ν¬μΈνΈ μ¶”κ°€**

#### **μ¶”κ°€λ μ—”λ“ν¬μΈνΈλ“¤**:
```python
@app.route('/api/register/guest', methods=['POST'])
def api_register_guest():
    try:
        data = request.get_json()
        name = data.get('name', '')
        exam_date = data.get('exam_date', '')
        
        if not name or not exam_date:
            return jsonify({'success': False, 'message': 'μ΄λ¦„κ³Ό μ‹ν—μΌμ„ μ…λ ¥ν•΄μ£Όμ„Έμ”.'})
        
        user_data = {
            'name': name,
            'exam_date': exam_date,
            'registration_date': datetime.now().isoformat(),
            'type': 'guest',
            'created_at': datetime.now().isoformat()
        }
        
        if save_user_data(user_data):
            return jsonify({
                'success': True, 
                'message': 'κ²μ¤νΈ λ“±λ΅μ΄ μ™„λ£λμ—μµλ‹λ‹¤.',
                'user_data': user_data
            })
        else:
            return jsonify({'success': False, 'message': 'λ“±λ΅ μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.'})
            
    except Exception as e:
        return jsonify({'success': False, 'message': f'μ„λ²„ μ¤λ¥: {str(e)}'})

@app.route('/api/register/user', methods=['POST'])
def api_register_user():
    try:
        data = request.get_json()
        name = data.get('name', '')
        phone = data.get('phone', '')
        exam_date = data.get('exam_date', '')
        
        if not name or not phone or not exam_date:
            return jsonify({'success': False, 'message': 'μ΄λ¦„, μ „ν™”λ²νΈ, μ‹ν—μΌμ„ λ¨λ‘ μ…λ ¥ν•΄μ£Όμ„Έμ”.'})
        
        user_data = {
            'name': name,
            'phone': phone,
            'exam_date': exam_date,
            'registration_date': datetime.now().isoformat(),
            'type': 'registered',
            'created_at': datetime.now().isoformat()
        }
        
        if save_user_data(user_data):
            return jsonify({
                'success': True, 
                'message': 'μ‚¬μ©μ λ“±λ΅μ΄ μ™„λ£λμ—μµλ‹λ‹¤.',
                'user_data': user_data
            })
        else:
            return jsonify({'success': False, 'message': 'λ“±λ΅ μ¤‘ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.'})
            
    except Exception as e:
        return jsonify({'success': False, 'message': f'μ„λ²„ μ¤λ¥: {str(e)}'})
```

### **2. datetime λ©”μ„λ“ μμ •**

#### **μμ • λ‚΄μ©**:
```python
# μμ • μ „ (μ¤λ¥ λ°μƒ)
datetime.now().toISOString()

# μμ • ν›„ (μ •μƒ μ‘λ™)
datetime.now().isoformat()
```

#### **μμ •λ νμΌλ“¤**:
- `app_v4.12.py` - κ²μ¤νΈ λ“±λ΅ API
- `app_v4.12.py` - μ‚¬μ©μ λ“±λ΅ API

### **3. ν™νμ΄μ§€ κ²½λ΅ μμ •**

#### **μμ • λ‚΄μ©**:
```javascript
// μμ • μ „ (μ¤λ¥ λ°μƒ)
window.location.replace('/home');

// μμ • ν›„ (μ •μƒ μ‘λ™)
window.location.replace('/');
```

#### **μμ •λ νμΌ**:
- `templates/user_registration.html` - κ²μ¤νΈ λ“±λ΅ μ™„λ£ ν›„ μ΄λ™
- `templates/user_registration.html` - μ‚¬μ©μ λ“±λ΅ μ™„λ£ ν›„ μ΄λ™

---

## β… ν•΄κ²° κ²°κ³Ό

### **1. API ν…μ¤νΈ μ„±κ³µ**
```bash
π§ κ²μ¤νΈ λ“±λ΅ API ν…μ¤νΈ μ‹μ‘
==================================================
π“΅ API μ‘λ‹µ μƒνƒ: 200
π“„ μ‘λ‹µ λ‚΄μ©: {
  "message": "κ²μ¤νΈ λ“±λ΅μ΄ μ™„λ£λμ—μµλ‹λ‹¤.",
  "success": true,
  "user_data": {
    "created_at": "2025-08-22T07:18:53.080345",
    "exam_date": "2025-09-13",
    "name": "κ²μ¤νΈ",
    "registration_date": "2025-08-22T07:18:53.080257",
    "type": "guest"
  }
}
β… κ²μ¤νΈ λ“±λ΅ μ„±κ³µ!
==================================================
π‰ κ²μ¤νΈ λ“±λ΅ ν…μ¤νΈ μ„±κ³µ!
```

### **2. κΈ°λ¥ μ •μƒν™”**
- β… κ²μ¤νΈ λ“±λ΅ API μ •μƒ μ‘λ™
- β… μ‚¬μ©μ λ°μ΄ν„° μ •μƒ μƒμ„±
- β… μ‘λ‹µ ν•μ‹ μ¬λ°”λ¦„
- β… ν™νμ΄μ§€ μ΄λ™ μ •μƒ μ‘λ™

### **3. μ‹μ¤ν… μ•μ •μ„± ν–¥μƒ**
- β… 404 μ¤λ¥ μ™„μ „ ν•΄κ²°
- β… datetime λ©”μ„λ“ μ¤λ¥ ν•΄κ²°
- β… νμ΄μ§€ μ΄λ™ μ¤λ¥ ν•΄κ²°

---

## π“‹ μμ •λ νμΌ λ©λ΅

### **1. app_v4.12.py**
- **μ¶”κ°€**: `/api/register/guest` μ—”λ“ν¬μΈνΈ
- **μ¶”κ°€**: `/api/register/user` μ—”λ“ν¬μΈνΈ
- **μμ •**: datetime λ©”μ„λ“ `toISOString()` β†’ `isoformat()`

### **2. templates/user_registration.html**
- **μμ •**: ν™νμ΄μ§€ κ²½λ΅ `/home` β†’ `/`
- **μμ •**: κ²μ¤νΈ λ“±λ΅ μ™„λ£ ν›„ μ΄λ™ κ²½λ΅
- **μμ •**: μ‚¬μ©μ λ“±λ΅ μ™„λ£ ν›„ μ΄λ™ κ²½λ΅

---

## π”§ κΈ°μ μ  κ°μ„ μ‚¬ν•­

### **1. API κµ¬μ΅° κ°μ„ **
- **μ΄μ „**: λ‹¨μΌ `/api/register` μ—”λ“ν¬μΈνΈ
- **ν„μ¬**: κ²μ¤νΈ/μ‚¬μ©μ κµ¬λ¶„λ μ—”λ“ν¬μΈνΈ
- **μ¥μ **: λ…ν™•ν• μ—­ν•  λ¶„λ¦¬ λ° μ¤λ¥ μ²λ¦¬ κ°μ„ 

### **2. μ¤λ¥ μ²λ¦¬ κ°•ν™”**
- **μ΄μ „**: μΌλ°μ μΈ μ¤λ¥ λ©”μ‹μ§€
- **ν„μ¬**: κµ¬μ²΄μ μΈ μ¤λ¥ μ›μΈ ν‘μ‹
- **μ¥μ **: λ””λ²„κΉ… λ° μ‚¬μ©μ κ²½ν— κ°μ„ 

### **3. λ°μ΄ν„° κµ¬μ΅° ν‘μ¤€ν™”**
- **μ¶”κ°€**: `created_at` ν•„λ“λ΅ λ“±λ΅ μ‹μ  λ…ν™•ν™”
- **μ¶”κ°€**: `type` ν•„λ“λ΅ μ‚¬μ©μ μ ν• κµ¬λ¶„
- **μ¥μ **: λ°μ΄ν„° μ¶”μ  λ° κ΄€λ¦¬ μ©μ΄μ„± ν–¥μƒ

---

## π― μλ°© μ΅°μΉ

### **1. μ½”λ“ λ¦¬λ·° κ°•ν™”**
- API μ—”λ“ν¬μΈνΈ μ •μμ™€ νΈμ¶ μΌμΉμ„± ν™•μΈ
- μ–Έμ–΄λ³„ λ©”μ„λ“ μ‚¬μ©λ²• κ²€μ¦
- νμ΄μ§€ κ²½λ΅ μ •ν™•μ„± κ²€μ¦

### **2. ν…μ¤νΈ μλ™ν™”**
- API μ—”λ“ν¬μΈνΈ μλ™ ν…μ¤νΈ
- λ“±λ΅ ν”„λ΅μ„Έμ¤ ν†µν•© ν…μ¤νΈ
- μ¤λ¥ μ‹λ‚λ¦¬μ¤ ν…μ¤νΈ

### **3. λ¬Έμ„ν™” κ°μ„ **
- API μ—”λ“ν¬μΈνΈ λ©λ΅ μ •λ¦¬
- μ‚¬μ©λ²• λ° μμ  μ½”λ“ μ κ³µ
- μ¤λ¥ μ½”λ“ λ° ν•΄κ²°λ°©λ²• λ¬Έμ„ν™”

---

## π“ μν–¥λ„ λ¶„μ„

### **1. μ‚¬μ©μ μν–¥**
- **μ΄μ „**: κ²μ¤νΈ λ“±λ΅ λ¶κ°€λ¥
- **ν„μ¬**: μ •μƒμ μΈ κ²μ¤νΈ λ“±λ΅ κ°€λ¥
- **κ°μ„ **: μ‚¬μ©μ κ²½ν— 100% λ³µκµ¬

### **2. μ‹μ¤ν… μν–¥**
- **μ΄μ „**: 404 μ¤λ¥λ΅ μΈν• μ„λ²„ λ¶€ν•
- **ν„μ¬**: μ •μƒμ μΈ API μ‘λ‹µ
- **κ°μ„ **: μ‹μ¤ν… μ•μ •μ„± ν–¥μƒ

### **3. κ°λ° μν–¥**
- **μ΄μ „**: λ””λ²„κΉ… μ‹κ°„ μ†μ”
- **ν„μ¬**: λ…ν™•ν• μ¤λ¥ μ²λ¦¬
- **κ°μ„ **: κ°λ° ν¨μ¨μ„± ν–¥μƒ

---

## π€ κ²°λ΅ 

### **μ„±κ³µμ μΌλ΅ ν•΄κ²°λ λ¬Έμ λ“¤**:

1. **β… API μ—”λ“ν¬μΈνΈ λ„λ½ λ¬Έμ  ν•΄κ²°**
   - κ²μ¤νΈ λ“±λ΅ API μ¶”κ°€
   - μ‚¬μ©μ λ“±λ΅ API μ¶”κ°€
   - 404 μ¤λ¥ μ™„μ „ ν•΄κ²°

2. **β… datetime λ©”μ„λ“ μ¤λ¥ ν•΄κ²°**
   - JavaScript λ©”μ„λ“ β†’ Python λ©”μ„λ“ μμ •
   - μ„λ²„ μ¤λ¥ μ™„μ „ ν•΄κ²°

3. **β… νμ΄μ§€ μ΄λ™ μ¤λ¥ ν•΄κ²°**
   - μλ»λ κ²½λ΅ μμ •
   - μ •μƒμ μΈ ν™νμ΄μ§€ μ΄λ™

### **μ‹μ¤ν… κ°μ„  ν¨κ³Ό**:

- **μ‚¬μ©μ λ“±λ΅ μ„±κ³µλ¥ **: 0% β†’ 100%
- **API μ‘λ‹µ μ •μƒλ¥ **: 0% β†’ 100%
- **μ‹μ¤ν… μ•μ •μ„±**: ν¬κ² ν–¥μƒ

### **λ‹¤μ λ‹¨κ³„ κ¶μ¥μ‚¬ν•­**:

1. **μ •κΈ°μ μΈ API ν…μ¤νΈ μ‹¤ν–‰**
2. **μ½”λ“ λ¦¬λ·° ν”„λ΅μ„Έμ¤ κ°•ν™”**
3. **μλ™ν™”λ ν…μ¤νΈ μ¤μ„νΈ κµ¬μ¶•**

---

**λ³΄κ³ μ„ μ‘μ„± μΌμ‹**: 2025-08-22  
**λ¬Έμ  ν•΄κ²° μ™„λ£**: β…  
**μ‹μ¤ν… μƒνƒ**: μ •μƒ μ‘λ™  
**λ‹¤μ κ²€ν†  μΌμ •**: 1μ£ΌμΌ ν›„
