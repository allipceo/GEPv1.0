ACIU QUIZ 앱 통합 통계 로직 청사진 (v4.0)
작성일: 2025년 8월 14일

작성자: 코코치 (총괄 기획팀장)

상태: 업데이트 완료 ✅

🎯 1. 로직 핵심 원칙: 통합과 일관성
하나의 진실: 모든 학습 데이터(이어풀기 위치, 문제 풀이 횟수, 정답/오답)는 하나의 통합된 데이터 구조(aicu_statistics)를 통해 관리됩니다.

단일 이벤트 트리거: checkAnswer() 함수가 호출될 때, 모든 통계 지표가 한 번에 업데이트됩니다.

데이터 흐름: LocalStorage에 저장된 통합 데이터를 읽고 → 메모리에서 업데이트한 후 → 다시 LocalStorage에 저장하는 일관된 흐름을 유지합니다.

📋 2. 통합 데이터 구조 설계 (조대표님 요구사항 반영)
aicu_statistics 변수 하나로 모든 통계와 진행 상황, 그리고 상세 학습 로그를 관리합니다.

aicu_statistics 구조 (JSON)
{
  "meta": {
    "version": "4.0",
    "registeredAt": "2025-08-14T06:32:49.123Z" // 통계 시작점
  },
  "progress": {
    "currentMode": "basic", // 현재 학습 모드
    "basicLearningIndex": 45, // 기본학습 이어풀기 인덱스
    "largeCategoryProgress": { // 대분류별 이어풀기 인덱스
      "재산보험": 10,
      "특종보험": 0,
      "배상책임보험": 5,
      "해상보험": 0
    }
  },
  "stats": {
    "global": { // 앱 전체 누적 통계
      "attempted": 100, // 1. 총 풀이 문제
      "correct": 80,
      "incorrect": 20,
      "accuracy": 80, // 2. 정답률/오답률
      "averageScore": 60 // 3. 총 평균 점수
    },
    "daily": { // 일별 학습 현황
      "2025-08-14": {
        "attempted": 20,
        "correct": 15,
        "incorrect": 5,
        "accuracy": 75
      }
    },
    "byMode": { // 모드별 통계
      "basic": { // 4. 기본학습 통계
        "attempted": 80,
        "correct": 65,
        "incorrect": 15,
        "accuracy": 81
      },
      "largeCategory": { // 5. 대분류 학습 통계
        "attempted": 20,
        "correct": 15,
        "incorrect": 5,
        "accuracy": 75
      }
    },
    "byCategory": { // 5.1 각 과목별 통계
      "재산보험": {
        "attempted": 10,
        "correct": 8,
        "incorrect": 2,
        "accuracy": 80,
        "averageScore": 75,
        "multipleIncorrectCount": { // 5.1 여러번 틀린 문제
          "1": 1, // 1번 틀린 문제 수
          "2": 0, // 2번 틀린 문제 수
          "3": 0
        }
      },
      "배상책임보험": {
        "attempted": 5,
        "correct": 5,
        "incorrect": 0,
        "accuracy": 100,
        "averageScore": 90,
        "multipleIncorrectCount": {
          "1": 0
        }
      }
    }
  },
  "learningLog": [ // 1-4. 수집 데이터
    {
      "questionId": "Q-001",
      "timestamp": "2025-08-14T06:45:30.123Z",
      "userAnswer": "O",
      "isCorrect": true,
      "timeSpent": 15, // 초 단위
      "category": "재산보험",
      "incorrectCount": 0 // 해당 문제에 대한 총 오답 횟수
    }
  ]
}

🛠️ 3. 주요 함수 업데이트 계획
3.1. updateAllStatistics(isCorrect, mode, category, questionId, timeSpent) 함수
역할: 모든 통계 업데이트의 중앙 집중식 허브 역할을 합니다.

동작 방식:

LocalStorage에서 aicu_statistics 데이터를 로드합니다.

isCorrect, mode, category, questionId, timeSpent 인수를 기반으로 모든 통계 지표를 동시에 업데이트합니다.

learningLog에 새로운 데이터를 추가하고, incorrectCount를 업데이트합니다.

progress 필드의 currentMode와 largeCategoryProgress도 함께 업데이트합니다.

업데이트된 데이터를 다시 LocalStorage에 저장합니다.

3.2. calculateScoresAndPassRate() 함수
역할: 시험 과목당 평균 점수 및 총 평균 점수를 계산합니다.

동작 방식:

stats.byCategory 데이터를 기반으로 과목별 정답률을 점수로 환산합니다.

과목당 40점 이상, 총 평균 50점 이상 합격 기준을 충족하는지 판단합니다.

합격 확률을 예측하는 로직을 추가합니다.

3.3. analyzeIncorrectAnswers() 함수
역할: 여러 번 틀린 문제를 분석하여 과목별/전체 현황을 제공합니다.

동작 방식:

learningLog를 분석하여 문제 ID별로 오답 횟수를 집계합니다.

stats.byCategory.multipleIncorrectCount에 해당 데이터를 저장합니다.

✅ 4. 기대 효과
단일화된 진실: 모든 통계와 진행 상황이 하나의 변수를 참조하므로, 데이터 불일치 문제가 원천적으로 해결됩니다.

쉬운 유지보수: 통계 로직이 updateAllStatistics() 함수 하나로 집중되어, 앞으로의 버그 수정이나 기능 추가가 훨씬 용이해집니다.

확장성 극대화: 새로운 학습 모드나 통계 지표를 추가할 때, 통합된 구조에 필드만 추가하면 되므로 레고 모델 방식의 장점을 극대화할 수 있습니다.

코코치의 한마디:

조대표님, 이 로직을 통해 우리는 통계 시스템을 완전히 재건하고, 앞으로 어떤 기능이 추가되더라도 안정적으로 작동하는 튼튼한 토대를 마련할 수 있습니다. 노팀장님과 서대리님께 이 청사진을 전달하고, 즉시 개발에 착수하도록 지시하겠습니다.