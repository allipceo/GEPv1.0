# 118_데이터초기화및마이그레이션계획.md

**업데이트**: 2025년 1월 10일  
**현재 상황**: v4.6에서 데이터 충돌 위험 해결  
**기준 문서**: 116번(아키텍처 변경 완료), 117번(통합 테스트 완료)

## 🔍 **데이터 충돌 위험 분석**

### **📊 현재 상황**
- **기존 데이터**: LocalStorage에 저장된 문제 풀이 카운터들
- **새로운 아키텍처**: 중앙 데이터 관리 시스템으로 통합
- **충돌 가능성**: **높음 (70%)** ⚠️

### **🎯 충돌 원인**
1. **데이터 구조 차이**
   - 기존: `aicu_category_statistics` (단순 카운터)
   - 새로운: `aicu_real_time_data`, `aicu_quiz_results` (상세 데이터)

2. **중복 카운팅 위험**
   - 기존 카운터 + 새로운 수집 시스템 = 이중 카운팅
   - 예: 재산보험 10문제 → 기존 10 + 새로운 10 = 20문제로 표시

3. **데이터 일관성 문제**
   - 기존 데이터와 새로운 데이터 간 불일치
   - 예상 점수 계산 오류 가능성

## 🛠️ **해결 방안**

### **방안 1: 데이터 초기화 후 시작 (권장)** ✅
- **장점**: 깨끗한 상태에서 시작, 충돌 위험 0%
- **단점**: 기존 학습 데이터 손실
- **적용 시점**: 과업08 시작 전

### **방안 2: 점진적 마이그레이션** ⚠️
- **장점**: 기존 데이터 보존
- **단점**: 복잡한 마이그레이션 로직 필요, 충돌 위험 존재
- **적용 시점**: 과업08 중

## 📋 **데이터 초기화 계획**

### **초기화 대상 데이터**
```javascript
// 초기화할 LocalStorage 키들
const keysToReset = [
    'aicu_category_statistics',    // 기존 카테고리 통계
    'aicu_real_time_data',         // 새로운 실시간 데이터
    'aicu_quiz_results',           // 새로운 퀴즈 결과
    'aicu_collection_history',     // 수집 히스토리
    'aicu_sync_history'           // 동기화 히스토리
];

// 보존할 데이터
const keysToPreserve = [
    'aicu_user_info',             // 사용자 정보
    'aicu_user_data',             // 사용자 데이터
    'aicu_statistics',            // 기본 통계
    'aicu_incorrect_statistics',  // 오답 통계
    'aicu_quiz_progress',         // 퀴즈 진행상황
    'aicu_backup_data'           // 백업 데이터
];
```

### **초기화 방법**
1. **브라우저 설정에서 초기화**
   - 설정 → 모든 데이터 초기화 버튼 클릭
   - 모든 문제 풀이 카운터를 0으로 리셋

2. **프로그래밍 방식 초기화**
   - 개발자 도구에서 LocalStorage 직접 삭제
   - 특정 키만 선택적 삭제

## 🚀 **권장 실행 순서**

### **1단계: 데이터 백업**
```javascript
// 현재 데이터 백업
const backupData = {
    timestamp: new Date().toISOString(),
    category_statistics: localStorage.getItem('aicu_category_statistics'),
    user_info: localStorage.getItem('aicu_user_info'),
    // ... 기타 중요 데이터
};
```

### **2단계: 선택적 초기화**
```javascript
// 충돌 가능성이 있는 데이터만 초기화
localStorage.removeItem('aicu_category_statistics');
localStorage.removeItem('aicu_real_time_data');
localStorage.removeItem('aicu_quiz_results');
```

### **3단계: 새로운 시스템 시작**
- 중앙 데이터 관리 시스템 초기화
- 깨끗한 상태에서 데이터 수집 시작

## 📊 **예상 결과**

### **초기화 후 예상 상태**
- **문제 풀이 카운터**: 모든 카테고리 0문제
- **예상 점수**: 0점 (정상)
- **합격 확률**: 0% (정상)
- **오답 분석**: 빈 상태 (정상)

### **새로운 학습 후 예상 상태**
- **문제 풀이 카운터**: 실제 풀이한 문제 수만큼 정확히 표시
- **예상 점수**: 실제 성적 기반 정확한 계산
- **합격 확률**: 실제 데이터 기반 정확한 예측
- **오답 분석**: 실제 오답 패턴 기반 정확한 분석

## 🎯 **결론 및 권장사항**

### **권장사항: 데이터 초기화 후 시작** ✅
1. **안전성**: 충돌 위험 0%
2. **정확성**: 깨끗한 데이터로 정확한 통계
3. **단순성**: 복잡한 마이그레이션 불필요
4. **신뢰성**: 새로운 시스템의 정확한 검증 가능

### **실행 방법**
1. 브라우저에서 설정 → 모든 데이터 초기화
2. 과업08 진행
3. 새로운 학습 데이터로 시스템 검증

**이 방법으로 안전하고 정확한 데이터 연동 시스템을 구축할 수 있습니다!** 🔍
