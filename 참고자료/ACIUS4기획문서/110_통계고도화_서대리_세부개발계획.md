# 110_통계고도화_서대리_세부개발계획.md

**작성자**: 서대리 (실제 개발 담당)  
**기준**: 109번 문서 + 노팀장-서대리 토의 내용  
**목표**: 단계별 검증을 통한 안전한 통계 고도화 구현  
**작성일**: 2025년 8월 15일 00:25 KST

---

## 🎯 **서대리 개발 기본 원칙**

### **1. 단계별 검증 필수**
- 각 단계 완료 후 노팀장, 코코치 검증
- 검증 통과 후에만 다음 단계 진행
- 문제 발생 시 즉시 롤백 및 재검토

### **2. 기존 시스템 보호 우선**
- 기존 기능 100% 유지
- 새로운 기능은 별도 파일로 분리
- 기존 파일 수정은 최소화 (5줄 이하)

### **3. 실현 가능한 코드량**
- 각 단계별 100-150줄 이하
- 복잡한 기능은 분할 구현
- 테스트 가능한 단위로 개발

---

## 📋 **Week1: 게스트 모드 + D-day 카운터**

### **🚀 Step 1: 개발 환경 준비 (Day 1 오전)**

#### **1.1 브랜치 생성 및 백업**
```bash
# 현재 상태 백업
git add .
git commit -m "v3.7 백업 - 통계 고도화 시작 전"

# 새로운 브랜치 생성
git checkout -b statistics-advanced-v3.8

# 백업 확인
git log --oneline -5
```

#### **1.2 성능 기준선 측정**
```javascript
// 성능 측정 함수 생성
function measurePerformance() {
    const startTime = performance.now();
    const localStorageSize = JSON.stringify(localStorage).length;
    
    return {
        pageLoadTime: performance.now() - startTime,
        localStorageSize: localStorageSize,
        timestamp: new Date().toISOString()
    };
}

// 기준선 저장
localStorage.setItem('performance_baseline', JSON.stringify(measurePerformance()));
```

#### **1.3 롤백 시스템 구축**
```javascript
// 롤백 관리자 생성
class RollbackManager {
    static createBackup(name) {
        const backup = {
            localStorage: {},
            timestamp: new Date().toISOString(),
            version: 'v3.7'
        };
        
        // 모든 localStorage 데이터 백업
        for (let i = 0; i < localStorage.length; i++) {
            const key = localStorage.key(i);
            backup.localStorage[key] = localStorage.getItem(key);
        }
        
        localStorage.setItem(`backup_${name}`, JSON.stringify(backup));
        console.log(`✅ 백업 생성 완료: ${name}`);
    }
    
    static rollback(name) {
        const backupData = localStorage.getItem(`backup_${name}`);
        if (backupData) {
            const backup = JSON.parse(backupData);
            
            // localStorage 초기화
            localStorage.clear();
            
            // 백업 데이터 복원
            Object.keys(backup.localStorage).forEach(key => {
                localStorage.setItem(key, backup.localStorage[key]);
            });
            
            console.log(`✅ 롤백 완료: ${name}`);
            location.reload();
        }
    }
}
```

**검증 항목**:
- [ ] 브랜치 생성 성공
- [ ] 성능 기준선 측정 완료
- [ ] 롤백 시스템 테스트 성공

---

### **🚀 Step 2: 게스트 모드 기본값 구현 (Day 1 오후)**

#### **2.1 파일 생성: `static/js/guest_mode_defaults.js`**
```javascript
// === 파일: static/js/guest_mode_defaults.js (100줄) ===

class GuestModeManager {
    static applyDefaults() {
        const userInfo = localStorage.getItem('aicu_user_data');
        
        if (!userInfo) {
            const defaultUserData = {
                name: '게스트',
                registration_date: '2025-08-01',    // 조대표님 지정
                exam_subject: 'AICU',
                exam_date: '2025-09-13',            // 조대표님 지정
                phone: '010-1234-5678',
                is_guest: true,
                created_at: new Date().toISOString()
            };
            
            localStorage.setItem('aicu_user_data', JSON.stringify(defaultUserData));
            this.initializeStatistics(defaultUserData);
            
            console.log('✅ 게스트 모드 기본값 적용 완료');
            return defaultUserData;
        }
        
        return JSON.parse(userInfo);
    }
    
    static initializeStatistics(userData) {
        const today = new Date().toISOString().split('T')[0];
        
        // 기존 통계가 없으면 초기화
        if (!localStorage.getItem('aicu_statistics')) {
            const initialStats = {
                registration_timestamp: userData.created_at,
                total_questions_attempted: 0,
                total_correct_answers: 0,
                accuracy_rate: 0,
                daily_progress: {
                    [today]: { attempted: 0, correct: 0, accuracy: 0 }
                },
                last_updated: userData.created_at
            };
            
            localStorage.setItem('aicu_statistics', JSON.stringify(initialStats));
        }
    }
    
    static isGuestMode() {
        const userData = JSON.parse(localStorage.getItem('aicu_user_data') || '{}');
        return userData.is_guest === true;
    }
    
    static updateGuestToUser(userData) {
        userData.is_guest = false;
        userData.updated_at = new Date().toISOString();
        localStorage.setItem('aicu_user_data', JSON.stringify(userData));
        console.log('✅ 게스트 모드에서 실제 사용자로 전환 완료');
    }
}

// 페이지 로드 시 자동 실행
document.addEventListener('DOMContentLoaded', () => {
    GuestModeManager.applyDefaults();
});

window.GuestModeManager = GuestModeManager;
```

#### **2.2 테스트 시나리오**
```javascript
// 테스트 함수
function testGuestMode() {
    // 1. localStorage 초기화
    localStorage.clear();
    
    // 2. 페이지 새로고침 시뮬레이션
    GuestModeManager.applyDefaults();
    
    // 3. 결과 확인
    const userData = JSON.parse(localStorage.getItem('aicu_user_data'));
    const stats = JSON.parse(localStorage.getItem('aicu_statistics'));
    
    console.log('게스트 모드 테스트 결과:', {
        userData: userData,
        stats: stats,
        isGuest: GuestModeManager.isGuestMode()
    });
    
    return userData && stats && GuestModeManager.isGuestMode();
}
```

**검증 항목**:
- [ ] 게스트 모드 자동 설정 성공
- [ ] 기존 사용자 데이터 보존 확인
- [ ] 통계 초기화 정상 작동
- [ ] 게스트 모드 전환 기능 정상

---

### **🚀 Step 3: D-day 카운터 구현 (Day 2)**

#### **3.1 파일 생성: `static/js/dday_counter.js`**
```javascript
// === 파일: static/js/dday_counter.js (80줄) ===

class DDayCounter {
    constructor(examDate = '2025-09-13') {
        this.examDate = new Date(examDate);
        this.init();
    }
    
    calculateDDay() {
        const today = new Date();
        const timeDiff = this.examDate - today;
        const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24));
        
        return {
            days: daysDiff,
            display: daysDiff > 0 ? `D-${daysDiff}` : daysDiff === 0 ? 'D-Day' : `D+${Math.abs(daysDiff)}`,
            status: daysDiff > 0 ? 'before' : daysDiff === 0 ? 'today' : 'after'
        };
    }
    
    updateDisplay() {
        const dday = this.calculateDDay();
        
        // 대문 페이지 D-day 표시
        const ddayElement = document.getElementById('dday-counter');
        if (ddayElement) {
            ddayElement.textContent = dday.display;
            ddayElement.className = `dday-${dday.status}`;
        }
        
        // 사용자 정보 영역에 표시
        const userInfoElement = document.getElementById('user-exam-info');
        if (userInfoElement) {
            const userData = JSON.parse(localStorage.getItem('aicu_user_data') || '{}');
            userInfoElement.innerHTML = `
                <div class="user-info">
                    <span>👤 ${userData.name || '게스트'}</span>
                    <span>📅 시험일: ${userData.exam_date || '2025-09-13'} (${dday.display})</span>
                </div>
            `;
        }
        
        return dday;
    }
    
    init() {
        // 즉시 업데이트
        this.updateDisplay();
        
        // 매일 자정에 업데이트
        const now = new Date();
        const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
        const msUntilMidnight = tomorrow.getTime() - now.getTime();
        
        setTimeout(() => {
            this.updateDisplay();
            // 이후 24시간마다 업데이트
            setInterval(() => this.updateDisplay(), 24 * 60 * 60 * 1000);
        }, msUntilMidnight);
    }
}

// 전역 인스턴스 생성
window.DDayCounter = new DDayCounter();
```

#### **3.2 CSS 스타일 추가: `static/css/dday_counter.css`**
```css
/* === 파일: static/css/dday_counter.css (30줄) === */

.dday-before {
    color: #e74c3c;
    font-weight: bold;
    font-size: 1.2em;
    background: linear-gradient(45deg, #ff6b6b, #ee5a24);
    padding: 8px 16px;
    border-radius: 20px;
    display: inline-block;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.dday-today {
    color: #f39c12;
    font-weight: bold;
    font-size: 1.3em;
    background: linear-gradient(45deg, #f39c12, #e67e22);
    padding: 10px 20px;
    border-radius: 25px;
    display: inline-block;
    box-shadow: 0 6px 12px rgba(0,0,0,0.2);
    animation: pulse 2s infinite;
}

.dday-after {
    color: #27ae60;
    font-weight: bold;
    font-size: 1.1em;
    background: linear-gradient(45deg, #2ecc71, #27ae60);
    padding: 6px 12px;
    border-radius: 15px;
    display: inline-block;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.user-info {
    display: flex;
    flex-direction: column;
    gap: 5px;
    padding: 10px;
    background: rgba(255,255,255,0.1);
    border-radius: 8px;
    margin: 10px 0;
}

.user-info span {
    font-size: 0.9em;
    color: #333;
}
```

**검증 항목**:
- [ ] D-day 정확한 계산 확인
- [ ] UI 표시 정상 확인
- [ ] 자동 업데이트 정상 작동
- [ ] 시험일 변경 시 업데이트 확인

---

### **🚀 Step 4: home.html 통합 (Day 3)**

#### **4.1 home.html 수정 (20줄 추가)**
```html
<!-- === templates/home.html 수정 (20줄 추가) === -->

<!-- 기존 head 섹션에 CSS 추가 -->
<link rel="stylesheet" href="/static/css/dday_counter.css">

<!-- 기존 사용자 정보 영역 수정 -->
<div id="user-exam-info" class="user-info-container">
    <!-- D-day 카운터가 여기에 표시됨 -->
</div>

<!-- 기존 주요 기능 섹션 위에 D-day 표시 영역 추가 -->
<div class="dday-container text-center mb-6">
    <h3 class="text-lg font-semibold mb-2">📅 시험까지 남은 시간</h3>
    <div id="dday-counter" class="dday-display"></div>
</div>

<!-- 기존 body 끝 부분에 스크립트 추가 -->
<script src="/static/js/guest_mode_defaults.js"></script>
<script src="/static/js/dday_counter.js"></script>
```

#### **4.2 통합 테스트**
```javascript
// 통합 테스트 함수
function testWeek1Integration() {
    // 1. localStorage 초기화
    localStorage.clear();
    
    // 2. 페이지 로드 시뮬레이션
    document.dispatchEvent(new Event('DOMContentLoaded'));
    
    // 3. 결과 확인
    const results = {
        guestMode: GuestModeManager.isGuestMode(),
        userData: JSON.parse(localStorage.getItem('aicu_user_data')),
        ddayElement: document.getElementById('dday-counter'),
        userInfoElement: document.getElementById('user-exam-info')
    };
    
    console.log('Week1 통합 테스트 결과:', results);
    
    return results.guestMode && results.userData && results.ddayElement;
}
```

**검증 항목**:
- [ ] 게스트 모드 자동 설정 확인
- [ ] D-day 카운터 화면 표시 확인
- [ ] 기존 기능 정상 작동 확인
- [ ] 성능 저하 없음 확인

---

## 📋 **Week1 완료 검증 체크리스트**

### **기능 검증**
- [ ] 앱 실행 시 자동 게스트 설정
- [ ] D-day 카운터 정확한 표시 (D-30 형태)
- [ ] 사용자 정보에 "게스트" 표시
- [ ] 시험일 정보 정확 표시

### **안정성 검증**
- [ ] 기존 기능 100% 정상 작동
- [ ] 기존 사용자 데이터 보존
- [ ] 성능 기준선 대비 10% 이내 유지
- [ ] 롤백 시스템 정상 작동

### **코드 품질 검증**
- [ ] 새 파일 2개 생성 (guest_mode_defaults.js, dday_counter.js)
- [ ] 기존 파일 수정 최소화 (home.html 20줄)
- [ ] CSS 파일 1개 생성 (dday_counter.css)
- [ ] 총 코드량 210줄 이하

---

## 🚀 **Week1 완료 후 다음 단계**

### **노팀장, 코코치 검증 요청**
1. **기능 검증**: 모든 체크리스트 항목 확인
2. **성능 검증**: 기준선 대비 성능 측정
3. **안정성 검증**: 롤백 시스템 테스트
4. **사용자 경험 검증**: 실제 사용 시나리오 테스트

### **검증 통과 시 Week2 진행**
- **Week2 목표**: 과목별 예상 점수 + 합격률
- **예상 코드량**: 230줄
- **주요 파일**: predicted_scores.js, predicted_scores.css

### **검증 실패 시 재작업**
- **문제점 분석**: 구체적인 오류 내용 파악
- **롤백 실행**: 안전한 상태로 복구
- **재계획 수립**: 문제 해결 방안 도출

---

## 📊 **Week1 성공 기준**

### **기능 완성도**
- 게스트 모드: 100% 완성
- D-day 카운터: 100% 완성
- 기존 기능 유지: 100% 유지

### **코드 품질**
- 새 파일: 2개
- 수정 파일: 1개 (home.html)
- 총 코드량: 210줄 이하
- 오류: 0개

### **성능 지표**
- 페이지 로딩 시간: 기준선 대비 10% 이내
- LocalStorage 사용량: 기준선 대비 20% 이내
- 메모리 사용량: 기준선 대비 15% 이내

---

**작성 완료**: 2025년 8월 15일 00:30 KST  
**상태**: Week1 개발 착수 준비 완료  
**다음 단계**: 조대표님 Week1 착수 지시 대기

**서대리는 이 계획서에 따라 단계별로 개발을 진행하고, 각 단계 완료 후 노팀장, 코코치의 검증을 받겠습니다.**
